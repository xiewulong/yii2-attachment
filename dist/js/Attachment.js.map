{"version":3,"sources":["webpack:///webpack/bootstrap 353e8710f05c8b57809b","webpack:///./vendor/xiewulong/yii2-attachment/js/Attachment.js"],"names":["$","window","document","undefined","Attachment","input","fn","prop","_name","name","$input","$parent","parent","action","attr","multiple","csrf","param","csrf_param","token","csrf_token","pre","before","value","upload","call","setName","createElements","d","callback","$form","submit","$iframe","appendTo","append","random","Date","toString","Math","floor","remove","on","trigger","attachment","jQuery"],"mappings":"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","file":"Attachment.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 353e8710f05c8b57809b","/*!\n * Attachment\n * xiewulong <xiewulong@vip.qq.com>\n * create: 2016/8/27\n * version: 0.0.1\n */\n\n(($, window, document, undefined) => {\n\n\tclass Attachment {\n\n\t\tconstructor(input, fn, prop = {}) {\n\t\t\tthis.input = input;\n\t\t\tthis._name = this.input.name;\n\t\t\tthis.$input = $(input);\n\t\t\tthis.$parent = this.$input.parent();\n\t\t\tthis.action = prop.action || this.$input.attr('data-attachment-upload-action');\n\t\t\tthis.multiple = prop.multiple || this.$input.attr('data-attachment-multiple');\n\t\t\tthis.csrf = {\n\t\t\t\tparam: prop.csrf_param || this.$input.attr('data-csrf-param') || '_csrf',\n\t\t\t\ttoken: prop.csrf_token || this.$input.attr('data-csrf-token'),\n\t\t\t};\n\t\t\tthis.pre = prop.pre || 'Attachment';\n\t\t\tthis.before = prop.before || function() {};\n\t\t\tthis.fn = fn;\n\n\t\t\tthis.input.value && this.action && this.fn && this.upload();\n\t\t}\n\n\t\tupload() {\n\t\t\tthis.before && this.before.call(this.input);\n\n\t\t\tthis.setName();\n\t\t\tthis.createElements();\n\n\t\t\twindow[this.name] = (d) => {\n\t\t\t\tthis.callback(d);\n\t\t\t};\n\n\t\t\tthis.$form.submit();\n\t\t}\n\n\t\tcreateElements() {\n\t\t\tthis.$iframe = $('<iframe style=\"display:none;\" name=\"' + this.name + '\"></iframe>').appendTo('body');\n\t\t\tthis.$form = $('<form style=\"display:none;\" action=\"' + this.action + '\" target=\"' + this.name + '\" method=\"post\" enctype=\"multipart/form-data\"></form>').appendTo('body');\n\t\t\tthis.multiple && this.$form.append('<input type=\"hidden\" name=\"multiple\" value=\"' + this.multiple + '\" />');\n\t\t\tthis.csrf.token && this.$form.append('<input type=\"hidden\" name=\"' + this.csrf.param + '\" value=\"' + this.csrf.token + '\" />');\n\t\t\tthis.$form.append('<input type=\"hidden\" name=\"name\" value=\"' + this.name + '\" />');\n\t\t\tthis.$form.append(this.input);\n\t\t}\n\n\t\tsetName() {\n\t\t\tlet random = (+ new Date()).toString() + Math.floor(Math.random() * 999 + 100).toString();\n\n\t\t\tthis.name = this.pre + random;\n\t\t\tthis.input.name = this.name + (this.multiple ? '[]' : '');\n\t\t}\n\n\t\tcallback(d) {\n\t\t\tthis.input.name = this._name;\n\t\t\tthis.input.value = '';\n\t\t\tthis.$parent.append(this.input);\n\t\t\tthis.$form.remove();\n\t\t\tthis.$iframe.remove();\n\t\t\tthis.fn.call(this.input, d);\n\t\t}\n\n\t}\n\n\t$(document).on('change', '[data-attachment-upload]', function() {\n\t\tnew Attachment(this, function(d) {\n\t\t\t$(this).trigger('uploaded.attachment.file', d);\n\t\t}, {\n\t\t\t'before': function() {\n\t\t\t\t$(this).trigger('upload.attachment.file');\n\t\t\t}\n\t\t});\n\t});\n\n\t$.fn.attachment = function(fn, prop) {\n\t\treturn this.on('change', function() {\n\t\t\tnew Attachment(this, fn, prop);\n\t\t});\n\t};\n\n})(jQuery, window, document);\n\n\n\n// WEBPACK FOOTER //\n// ./vendor/xiewulong/yii2-attachment/js/Attachment.js"],"sourceRoot":""}