"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}();!function(t,e,n,i){var a=function(){function n(e,a){var s=arguments.length<=2||arguments[2]===i?{}:arguments[2];_classCallCheck(this,n),this.input=e,this._name=this.input.name,this.$input=t(e),this.$parent=this.$input.parent(),this.action=s.action||this.$input.attr("data-attachment-upload-action"),this.multiple=s.multiple||this.$input.attr("data-attachment-multiple"),this.csrf={param:s.csrf_param||this.$input.attr("data-csrf-param")||"_csrf",token:s.csrf_token||this.$input.attr("data-csrf-token")},this.pre=s.pre||"Attachment",this.before=s.before||function(){},this.fn=a,this.input.value&&this.action&&this.fn&&this.upload()}return _createClass(n,[{key:"upload",value:function(){var t=this;this.before&&this.before.call(this.input),this.setName(),this.createElements(),e[this.name]=function(e){t.callback(e)},this.$form.submit()}},{key:"createElements",value:function(){this.$iframe=t('<iframe style="display:none;" name="'+this.name+'"></iframe>').appendTo("body"),this.$form=t('<form style="display:none;" action="'+this.action+'" target="'+this.name+'" method="post" enctype="multipart/form-data"></form>').appendTo("body"),this.multiple&&this.$form.append('<input type="hidden" name="multiple" value="'+this.multiple+'" />'),this.csrf.token&&this.$form.append('<input type="hidden" name="'+this.csrf.param+'" value="'+this.csrf.token+'" />'),this.$form.append('<input type="hidden" name="name" value="'+this.name+'" />'),this.$form.append(this.input)}},{key:"setName",value:function(){var t=(+new Date).toString()+Math.floor(999*Math.random()+100).toString();this.name=this.pre+t,this.input.name=this.name+(this.multiple?"[]":"")}},{key:"callback",value:function(t){this.input.name=this._name,this.input.value="",this.$parent.append(this.input),this.$form.remove(),this.$iframe.remove(),this.fn.call(this.input,t)}}]),n}();t(n).on("change","[data-attachment-upload]",function(){new a(this,function(e){t(this).trigger("uploaded.attachment.file",e)},{before:function(){t(this).trigger("upload.attachment.file")}})}),t.fn.attachment=function(t,e){return this.on("change",function(){new a(this,t,e)})}}(jQuery,window,document);
//# sourceMappingURL=Attachment.min.js.map
